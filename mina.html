<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8" />
  <title>Mina Sombria - Pixel Edition</title>
  <link rel="stylesheet" href="mina.css">
</head>

<body>
  <div class="container">
    <h1>MINA SOMBRIA - PIXEL EDITION</h1>

    <!-- Minigame 1 -->
    <div id="game">
      <p id="timer">TEMPO: 40s</p>
      <p>QUEBRE AS PEDRAS DO CAMINHO:</p>
      <p id="contador">PEDRAS: 0/9</p>
      <div>
        <div class="pedra" onclick="quebrar(this, 1)">
          <img src="https://placehold.co/64x64/555/222?text=STONE" alt="Pixel art style stone block" />
        </div>
        <div class="pedra" onclick="quebrar(this, 1)">
          <img src="https://placehold.co/64x64/555/222?text=STONE" alt="Pixel art style stone block" />
        </div>
        <div class="pedra" onclick="quebrar(this, 1)">
          <img src="https://placehold.co/64x64/555/222?text=STONE" alt="Pixel art style stone block" />
        </div>
        <div class="pedra" onclick="quebrar(this, 1)">
          <img src="https://placehold.co/64x64/555/222?text=STONE" alt="Pixel art style stone block" />
        </div>
        <div class="pedra" onclick="quebrar(this, 1)">
          <img src="https://placehold.co/64x64/555/222?text=STONE" alt="Pixel art style stone block" />
        </div>
        <div class="pedra" onclick="quebrar(this, 1)">
          <img src="https://placehold.co/64x64/555/222?text=STONE" alt="Pixel art style stone block" />
        </div>
        <div class="pedra" onclick="quebrar(this, 1)">
          <img src="https://placehold.co/64x64/555/222?text=STONE" alt="Pixel art style stone block" />
        </div>
        <div class="pedra" onclick="quebrar(this, 1)">
          <img src="https://placehold.co/64x64/555/222?text=STONE" alt="Pixel art style stone block" />
        </div>
        <div class="pedra" onclick="quebrar(this, 1)">
          <img src="https://placehold.co/64x64/555/222?text=STONE" alt="Pixel art style stone block" />
        </div>
      </div>
    </div>

    <!-- Game Over -->
    <div id="gameover">
      <p>TEMPO ESGOTADO!</p>
      <p>Você não conseguiu quebrar todas as pedras a tempo.</p>
      <button onclick="reiniciarJogo()">REINICIAR</button>
    </div>

    <!-- Enigma Carvão -->
    <div id="enigma">
      <p>VOCÊ ENCONTRA UM ENIGMA:</p>
      <blockquote>“Qual bloco nasce no escuro, se usa na fornalha para queimar itens e mancha os dedos de preto?”</blockquote>
      <input type="text" id="resposta" placeholder="Digite sua resposta" />
      <br />
      <button onclick="verificar()">RESPONDER</button>
      <p id="feedback"></p>
    </div>

    <!-- Minigame 2 -->
    <div id="game2">
      <p id="timer2">TEMPO: 40s</p>
      <p>QUEBRE AS PEDRAS DO CAMINHO:</p>
      <p id="contador2">PEDRAS: 0/9</p>
      <div>
        <div class="pedra" onclick="quebrar(this, 2)">
          <img src="https://placehold.co/64x64/555/222?text=STONE" alt="Pixel art style stone block" />
        </div>
        <div class="pedra" onclick="quebrar(this, 2)">
          <img src="https://placehold.co/64x64/555/222?text=STONE" alt="Pixel art style stone block" />
        </div>
        <div class="pedra" onclick="quebrar(this, 2)">
          <img src="https://placehold.co/64x64/555/222?text=STONE" alt="Pixel art style stone block" />
        </div>
        <div class="pedra" onclick="quebrar(this, 2)">
          <img src="https://placehold.co/64x64/555/222?text=STONE" alt="Pixel art style stone block" />
        </div>
        <div class="pedra" onclick="quebrar(this, 2)">
          <img src="https://placehold.co/64x64/555/222?text=STONE" alt="Pixel art style stone block" />
        </div>
        <div class="pedra" onclick="quebrar(this, 2)">
          <img src="https://placehold.co/64x64/555/222?text=STONE" alt="Pixel art style stone block" />
        </div>
        <div class="pedra" onclick="quebrar(this, 2)">
          <img src="https://placehold.co/64x64/555/222?text=STONE" alt="Pixel art style stone block" />
        </div>
        <div class="pedra" onclick="quebrar(this, 2)">
          <img src="https://placehold.co/64x64/555/222?text=STONE" alt="Pixel art style stone block" />
        </div>
        <div class="pedra" onclick="quebrar(this, 2)">
          <img src="https://placehold.co/64x64/555/222?text=STONE" alt="Pixel art style stone block" />
        </div>
      </div>
    </div>

    <!-- Enigma Ferro -->
    <div id="enigmaFerro">
      <p>VOCÊ ENCONTRA OUTRO ENIGMA:</p>
      <blockquote>“Sou um minério cinza e que cria ferramentas cinzas. Quem sou eu?”</blockquote>
      <input type="text" id="respostaFerro" placeholder="Digite sua resposta" />
      <br />
      <button onclick="verificarFerro()">RESPONDER</button>
      <p id="feedbackFerro"></p>
    </div>

    <!-- Minigame 3 -->
    <div id="game3">
      <p id="timer3">TEMPO: 40s</p>
      <p>QUEBRE AS PEDRAS DO CAMINHO:</p>
      <p id="contador3">PEDRAS: 0/9</p>
      <div>
        <div class="pedra" onclick="quebrar(this, 3)">
          <img src="https://placehold.co/64x64/555/222?text=STONE" alt="Pixel art style stone block" />
        </div>
        <div class="pedra" onclick="quebrar(this, 3)">
          <img src="https://placehold.co/64x64/555/222?text=STONE" alt="Pixel art style stone block" />
        </div>
        <div class="pedra" onclick="quebrar(this, 3)">
          <img src="https://placehold.co/64x64/555/222?text=STONE" alt="Pixel art style stone block" />
        </div>
        <div class="pedra" onclick="quebrar(this, 3)">
          <img src="https://placehold.co/64x64/555/222?text=STONE" alt="Pixel art style stone block" />
        </div>
        <div class="pedra" onclick="quebrar(this, 3)">
          <img src="https://placehold.co/64x64/555/222?text=STONE" alt="Pixel art style stone block" />
        </div>
        <div class="pedra" onclick="quebrar(this, 3)">
          <img src="https://placehold.co/64x64/555/222?text=STONE" alt="Pixel art style stone block" />
        </div>
        <div class="pedra" onclick="quebrar(this, 3)">
          <img src="https://placehold.co/64x64/555/222?text=STONE" alt="Pixel art style stone block" />
        </div>
        <div class="pedra" onclick="quebrar(this, 3)">
          <img src="https://placehold.co/64x64/555/222?text=STONE" alt="Pixel art style stone block" />
        </div>
        <div class="pedra" onclick="quebrar(this, 3)">
          <img src="https://placehold.co/64x64/555/222?text=STONE" alt="Pixel art style stone block" />
        </div>
      </div>
    </div>

    <!-- Luta com o Zumbi -->
    <div id="fight">
      <p>UM ZUMBI APARECE!</p>
      <img id="zombie-img" src="https://placehold.co/150x150/444/f00?text=ZOMBIE" alt="Pixel art zombie with green skin and torn clothes" />
      <p>VIDA: <span id="vidaJogador">100</span></p>
      <p>ZUMBI: <span id="vidaZumbi">100</span></p>
      <button class="attack-btn" onclick="atacar()">ATACAR</button>
      <p id="resultadoLuta"></p>
    </div>

    <!-- Enigma Diamante -->
    <div id="enigmaDiamante">
      <p>ENIGMA FINAL:</p>
      <blockquote>“É o bloco azul brilhante e raro que usamos para ferramentas muito fortes!”</blockquote>
      <input type="text" id="respostaDiamante" placeholder="Digite sua resposta" />
      <br />
      <button onclick="verificarDiamante()">RESPONDER</button>
      <p id="feedbackDiamante"></p>
    </div>

    <!-- Minigame Final - Diamante -->
    <div id="gameDiamante">
      <p>QUEBRE OS BLOCOS DE DIAMANTE:</p>
      <div id="diamanteBlocksContainer"></div>
      <p id="contadorDiamante">BLOCOS: 0/30</p>
    </div>

    <!-- Final -->
    <div id="finalMessage" style="display:none;">
      <h2>PARABÉNS!</h2>
      <p>Você conquistou a mina sombria.</p>
      <a href="templo.html">IR PARA O TEMPLO</a>
    </div>

    <!-- Mensagem derrota -->
    <div id="defeatMessage">
      <p>VOCÊ FOI DERROTADO!</p>
      <button onclick="reiniciarJogo()">REINICIAR</button>
    </div>
  </div>

  <script>
    // Variáveis do jogo
    let jogos = {
      1: { quebradas: 0 },
      2: { quebradas: 0 },
      3: { quebradas: 0 },
      4: { quebradas: 0 },
    };

    let timerId, timerId2, timerId3;
    let lutando = false;
    let vidaJogador = 100;
    let vidaZumbi = 100;

    // Cria os blocos de diamante dinamicamente
    function criarBlocosDiamante() {
      const container = document.getElementById('diamanteBlocksContainer');
      container.innerHTML = '';
      
      for (let i = 0; i < 30; i++) {
        const bloco = document.createElement('div');
        bloco.classList.add('diamante');
        bloco.onclick = () => quebrar(bloco, 4);

        const img = document.createElement('img');
        img.src = "https://placehold.co/64x64/39f/fff?text=DIAMOND";
        img.alt = "Pixel art diamond block with blue color and shiny effect";
        
        bloco.appendChild(img);
        container.appendChild(bloco);
      }
    }

    // Inicia o timer para cada fase
    function iniciarTimerFase(fase) {
      let tempo = 40;
      let timerElement, contadorElement, totalPedras = 9;

      if (fase === 1) {
        timerElement = document.getElementById('timer');
        contadorElement = document.getElementById('contador');
        jogos[1].quebradas = 0;
        document.querySelectorAll('#game .pedra').forEach(p => resetPedra(p, 1));
        mostrarGame(true);
        mostrarEnigma(false);
        mostrarGame2(false);
        mostrarEnigmaFerro(false);
        mostrarGame3(false);
        mostrarLuta(false);
        mostrarEnigmaDiamante(false);
        mostrarGameDiamante(false);
        mostrarFinal(false);
        mostrarGameOver(false);
        mostrarDefeat(false);
      } 
      else if (fase === 2) {
        timerElement = document.getElementById('timer2');
        contadorElement = document.getElementById('contador2');
        jogos[2].quebradas = 0;
        document.querySelectorAll('#game2 .pedra').forEach(p => resetPedra(p, 2));
        mostrarGame(false);
        mostrarEnigma(false);
        mostrarGame2(true);
        mostrarEnigmaFerro(false);
        mostrarGame3(false);
        mostrarLuta(false);
        mostrarEnigmaDiamante(false);
        mostrarGameDiamante(false);
        mostrarFinal(false);
        mostrarGameOver(false);
        mostrarDefeat(false);
      } 
      else if (fase === 3) {
        timerElement = document.getElementById('timer3');
        contadorElement = document.getElementById('contador3');
        jogos[3].quebradas = 0;
        document.querySelectorAll('#game3 .pedra').forEach(p => resetPedra(p, 3));
        mostrarGame(false);
        mostrarEnigma(false);
        mostrarGame2(false);
        mostrarEnigmaFerro(false);
        mostrarGame3(true);
        mostrarLuta(false);
        mostrarEnigmaDiamante(false);
        mostrarGameDiamante(false);
        mostrarFinal(false);
        mostrarGameOver(false);
        mostrarDefeat(false);
      } 
      else if (fase === 4) {
        criarBlocosDiamante();
        jogos[4].quebradas = 0;
        document.getElementById('contadorDiamante').textContent = 'BLOCOS: 0/30';
        mostrarGame(false);
        mostrarEnigma(false);
        mostrarGame2(false);
        mostrarEnigmaFerro(false);
        mostrarGame3(false);
        mostrarLuta(false);
        mostrarEnigmaDiamante(false);
        mostrarGameDiamante(true);
        mostrarFinal(false);
        mostrarGameOver(false);
        mostrarDefeat(false);
        return;
      }

      if (timerId) clearInterval(timerId);
      timerElement.textContent = `TEMPO: ${tempo}s`;

      timerId = setInterval(() => {
        tempo--;
        timerElement.textContent = `TEMPO: ${tempo}s`;
        
        if (tempo <= 0) {
          clearInterval(timerId);
          mostrarGameOver(true);
        }
      }, 1000);
    }

    // Reseta o estado de uma pedra
    function resetPedra(pedra, fase) {
      pedra.style.pointerEvents = 'auto';
      pedra.classList.remove('quebrando');
      pedra.style.opacity = '1';
      pedra.style.display = 'inline-block';
      
      if (pedra.querySelector('img')) {
        if (fase === 1 || fase === 2 || fase === 3) {
          pedra.querySelector('img').src = "https://placehold.co/64x64/555/222?text=STONE";
        } else if (fase === 4) {
          pedra.querySelector('img').src = "https://placehold.co/64x64/39f/fff?text=DIAMOND";
        }
      }
    }

    // Quebra uma pedra/diamante
    function quebrar(pedra, fase) {
      if (pedra.classList.contains('quebrando')) return;

      pedra.classList.add('quebrando');
      pedra.style.pointerEvents = 'none';

      setTimeout(() => {
        pedra.style.display = 'none';
      }, 500);

      jogos[fase].quebradas++;

      if (fase === 1) {
        document.getElementById('contador').textContent = `PEDRAS: ${jogos[1].quebradas}/9`;
        if (jogos[1].quebradas >= 9) {
          clearInterval(timerId);
          mostrarGame(false);
          mostrarEnigma(true);
        }
      } 
      else if (fase === 2) {
        document.getElementById('contador2').textContent = `PEDRAS: ${jogos[2].quebradas}/9`;
        if (jogos[2].quebradas >= 9) {
          clearInterval(timerId);
          mostrarGame2(false);
          mostrarEnigmaFerro(true);
        }
      } 
      else if (fase === 3) {
        document.getElementById('contador3').textContent = `PEDRAS: ${jogos[3].quebradas}/9`;
        if (jogos[3].quebradas >= 9) {
          clearInterval(timerId);
          mostrarGame3(false);
          mostrarLuta(true);
          iniciarLuta();
        }
      } 
      else if (fase === 4) {
        jogos[4].quebradas++;
        document.getElementById('contadorDiamante').textContent = `BLOCOS: ${jogos[4].quebradas}/30`;
        pedra.style.display = 'none';
        if (jogos[4].quebradas >= 30) {
          mostrarGameDiamante(false);
          mostrarFinal(true);
        }
      }
    }

    // Funções para mostrar/ocultar seções
    function mostrarGame(show) {
      document.getElementById('game').style.display = show ? 'block' : 'none';
    }

    function mostrarEnigma(show) {
      document.getElementById('enigma').style.display = show ? 'block' : 'none';
    }

    function mostrarGame2(show) {
      document.getElementById('game2').style.display = show ? 'block' : 'none';
    }

    function mostrarEnigmaFerro(show) {
      document.getElementById('enigmaFerro').style.display = show ? 'block' : 'none';
    }

    function mostrarGame3(show) {
      document.getElementById('game3').style.display = show ? 'block' : 'none';
    }

    function mostrarLuta(show) {
      document.getElementById('fight').style.display = show ? 'block' : 'none';
    }

    function mostrarEnigmaDiamante(show) {
      document.getElementById('enigmaDiamante').style.display = show ? 'block' : 'none';
    }

    function mostrarGameDiamante(show) {
      document.getElementById('gameDiamante').style.display = show ? 'block' : 'none';
    }

    function mostrarGameOver(show) {
      document.getElementById('gameover').style.display = show ? 'block' : 'none';
    }

    function mostrarFinal(show) {
      document.getElementById('finalMessage').style.display = show ? 'block' : 'none';
    }

    function mostrarDefeat(show) {
      document.getElementById('defeatMessage').style.display = show ? 'block' : 'none';
    }

    // Funções para os enigmas
    function verificar() {
      const resposta = document.getElementById('resposta').value.toLowerCase().trim();
      const feedback = document.getElementById('feedback');
      
      if (resposta === 'carvão' || resposta === 'carvao') {
        feedback.style.color = 'var(--success-color)';
        feedback.textContent = 'CORRETO! Avance para a próxima fase.';
        
        setTimeout(() => {
          mostrarEnigma(false);
          iniciarTimerFase(2);
          document.getElementById('resposta').value = '';
          feedback.textContent = '';
        }, 1500);
      } 
      else {
        feedback.style.color = 'var(--danger-color)';
        feedback.textContent = 'ERRO. Tente novamente.';
      }
    }

    function verificarFerro() {
      const resposta = document.getElementById('respostaFerro').value.toLowerCase().trim();
      const feedback = document.getElementById('feedbackFerro');
      
      if (resposta === 'ferro') {
        feedback.style.color = 'var(--success-color)';
        feedback.textContent = 'CORRETO! Avance para a próxima fase.';
        
        setTimeout(() => {
          mostrarEnigmaFerro(false);
          iniciarTimerFase(3);
          document.getElementById('respostaFerro').value = '';
          feedback.textContent = '';
        }, 1500);
      } 
      else {
        feedback.style.color = 'var(--danger-color)';
        feedback.textContent = 'ERRO. Tente novamente.';
      }
    }

    function verificarDiamante() {
      const resposta = document.getElementById('respostaDiamante').value.toLowerCase().trim();
      const feedback = document.getElementById('feedbackDiamante');
      
      if (resposta === 'diamante') {
        feedback.style.color = 'var(--success-color)';
        feedback.textContent = 'CORRETO! Agora quebre os blocos!';
        
        setTimeout(() => {
          mostrarEnigmaDiamante(false);
          iniciarTimerFase(4);
          document.getElementById('respostaDiamante').value = '';
          feedback.textContent = '';
        }, 1500);
      } 
      else {
        feedback.style.color = 'var(--danger-color)';
        feedback.textContent = 'ERRO. Tente novamente.';
      }
    }

    // Sistema de combate
    function iniciarLuta() {
      vidaJogador = 100;
      vidaZumbi = 100;
      atualizarVida();
      document.getElementById('resultadoLuta').textContent = '';
    }

    function atualizarVida() {
      document.getElementById('vidaJogador').textContent = vidaJogador;
      document.getElementById('vidaZumbi').textContent = vidaZumbi;
    }

    function atacar() {
        if (vidaJogador <= 0 || vidaZumbi <= 0) return;

        // Efeito visual do ataque
        const zombieImg = document.getElementById('zombie-img');
        zombieImg.style.transform = 'translate(5px, 5px)';
        setTimeout(() => {
            zombieImg.style.transform = 'translate(0, 0)';
        }, 100);

        const danoJogador = Math.floor(Math.random() * 15) + 5;
        vidaZumbi -= danoJogador;
        if (vidaZumbi < 0) vidaZumbi = 0;

        const danoZumbi = Math.floor(Math.random() * 12) + 3;
        vidaJogador -= danoZumbi;
        if (vidaJogador < 0) vidaJogador = 0;

        atualizarVida();

        let resultado = `Você causou ${danoJogador} de dano. Zumbi causou ${danoZumbi} de dano.`;

        if (vidaZumbi === 0) {
            resultado += ' Você venceu o zumbi! Avance para o enigma final.';
            setTimeout(() => {
                mostrarLuta(false);
                mostrarEnigmaDiamante(true);
            }, 1500);
        } else if (vidaJogador === 0) {
            resultado += ' Você foi derrotado...';
            setTimeout(() => {
                mostrarLuta(false);
                mostrarDefeat(true);
            }, 1500);
        }

        document.getElementById('resultadoLuta').textContent = resultado;
    }

    // Reiniciar o jogo
    function reiniciarJogo() {
        mostrarGameOver(false);
        mostrarDefeat(false);
        iniciarTimerFase(1);
    }

    // Efeitos sonoros simples
    function playSound(type) {
        const sounds = {
            break: new Audio('https://assets.codepen.io/215128/break.mp3'),
            win: new Audio('https://assets.codepen.io/215128/win.mp3'),
            lose: new Audio('https://assets.codepen.io/215128/lose.mp3')
        };
        
        if (sounds[type]) {
            sounds[type].volume = 0.3;
            sounds[type].play().catch(e => console.log('Autoplay prevented:', e));
        }
    }

    // Inicia o jogo na primeira fase
    iniciarTimerFase(1);
  </script>
</body>
</html>
